<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Trash Sorting Game</title>
<style>
body { margin:0; overflow:hidden; background:#eef; font-family:sans-serif; }
canvas { display:block; }
</style>
</head>
<body>
<canvas id="game"></canvas>

<script>
const canvas = document.getElementById('game');
const ctx = canvas.getContext('2d');
let w = canvas.width = window.innerWidth;
let h = canvas.height = window.innerHeight;

window.addEventListener('resize',()=>{ w=canvas.width=window.innerWidth; h=canvas.height=window.innerHeight; });

// BIN DEFINITIONS
const bins = [
  {name:'Paper', x:50, y:h-160, w:120, h:150, type:'paper', color:'#f8f8f8'},
  {name:'Glass', x:200, y:h-160, w:120, h:150, type:'glass', color:'#c8f0ff'},
  {name:'Metal', x:350, y:h-160, w:120, h:150, type:'metal', color:'#ccc'},
  {name:'Plastic', x:500, y:h-160, w:120, h:150, type:'plastic', color:'#ffd'},
  {name:'Compost', x:650, y:h-160, w:120, h:150, type:'compost', color:'#aaffaa'}
];

// TRASH TYPES WITH SIMPLE SHAPES
const trashTypes = [
  {name:'Banana', type:'compost', draw:(ctx,x,y)=>{ ctx.fillStyle='#ffcc33'; ctx.beginPath(); ctx.moveTo(x,y); ctx.quadraticCurveTo(x+20,y-40,x+40,y); ctx.quadraticCurveTo(x+20,y+10,x,y); ctx.fill(); }},
  {name:'Tin Can', type:'metal', draw:(ctx,x,y)=>{ ctx.fillStyle='#888'; ctx.fillRect(x,y,30,40); }},
  {name:'Newspaper', type:'paper', draw:(ctx,x,y)=>{ ctx.fillStyle='#fff'; ctx.fillRect(x,y,40,25); ctx.strokeRect(x,y,40,25); }},
  {name:'Cardboard', type:'paper', draw:(ctx,x,y)=>{ ctx.fillStyle='#d8a26d'; ctx.fillRect(x,y,40,30); ctx.strokeRect(x,y,40,30); }},
  {name:'Apple Core', type:'compost', draw:(ctx,x,y)=>{ ctx.fillStyle='#ff6666'; ctx.beginPath(); ctx.arc(x+15,y+15,15,0,Math.PI*2); ctx.fill(); }},
  {name:'Wine Bottle', type:'glass', draw:(ctx,x,y)=>{ ctx.fillStyle='#5a2a2a'; ctx.fillRect(x+10,y,10,50); ctx.beginPath(); ctx.arc(x+15,y,5,0,Math.PI*2); ctx.fill(); }},
  {name:'Beer Bottle', type:'glass', draw:(ctx,x,y)=>{ ctx.fillStyle='#8c5e2c'; ctx.fillRect(x+10,y,10,45); ctx.beginPath(); ctx.arc(x+15,y,5,0,Math.PI*2); ctx.fill(); }},
  {name:'Milk Jug', type:'plastic', draw:(ctx,x,y)=>{ ctx.fillStyle='#fff'; ctx.fillRect(x+5,y,20,40); ctx.strokeRect(x+5,y,20,40); }},
  {name:'Plastic Container', type:'plastic', draw:(ctx,x,y)=>{ ctx.fillStyle='#0af'; ctx.fillRect(x,y,30,30); }}  
];

// DUMP TRUCK
let truck = {x:-200, y:50, w:200, h:80, speed:2, dumping:false};

// TRASH ARRAY
let trashItems = [];

// DRAGGING
let dragging=null;
let offsetX=0, offsetY=0;

// SOUND
const chime = new Audio('https://freesound.org/data/previews/341/341695_6263153-lq.mp3');

// CREATE PILE OF 10 ITEMS
function dumpPile(){
  for(let i=0;i<10;i++){
    const type = trashTypes[Math.floor(Math.random()*trashTypes.length)];
    trashItems.push({
      x:truck.x+50+Math.random()*100,
      y:truck.y+truck.h+10+Math.random()*20,
      type:type.type,
      name:type.name,
      draw:type.draw
    });
  }
}

// MOUSE EVENTS
canvas.addEventListener('mousedown', e=>{
  for(let i=trashItems.length-1;i>=0;i--){
    const t=trashItems[i];
    if(e.offsetX>t.x && e.offsetX<t.x+50 && e.offsetY>t.y && e.offsetY<t.y+50){
      dragging=t;
      offsetX=e.offsetX-t.x;
      offsetY=e.offsetY-t.y;
      break;
    }
  }
});

canvas.addEventListener('mousemove', e=>{
  if(dragging){
    dragging.x=e.offsetX-offsetX;
    dragging.y=e.offsetY-offsetY;
  }
});

canvas.addEventListener('mouseup', e=>{
  if(dragging){
    let placed=false;
    for(let b of bins){
      if(dragging.x+25>b.x && dragging.x+25<b.x+b.w && dragging.y+25>b.y && dragging.y+25<b.y+b.h){
        placed=true;
        if(dragging.type===b.type){
          // correct
          showCorrect(dragging);
          trashItems.splice(trashItems.indexOf(dragging),1);
        } else {
          // wrong
          showWrong(dragging);
          dragging.x=truck.x+50; // reset position
          dragging.y=truck.y+truck.h+10;
        }
      }
    }
    dragging=null;
  }
});

// CORRECT / WRONG FEEDBACK
function showCorrect(t){
  // golden ring
  const ring = {x:t.x, y:t.y, r:0, alpha:1};
  correctRings.push(ring);
  chime.play();
}

function showWrong(t){
  wrongFlashes.push({x:t.x, y:t.y, size:50, alpha:1});
}

// ANIMATION
let correctRings=[];
let wrongFlashes=[];

function draw(){
  ctx.clearRect(0,0,w,h);

  // draw bins
  for(let b of bins){
    ctx.fillStyle=b.color;
    ctx.fillRect(b.x,b.y,b.w,b.h);
    ctx.strokeStyle='#555';
    ctx.strokeRect(b.x,b.y,b.w,b.h);
    ctx.fillStyle='#000';
    ctx.font='16px sans-serif';
    ctx.fillText(b.name,b.x+10,b.y+20);
  }

  // draw truck
  ctx.fillStyle='#444';
  ctx.fillRect(truck.x,truck.y,truck.w,truck.h);
  ctx.fillStyle='#666';
  ctx.fillRect(truck.x+20,truck.y-20,160,20); // truck top

  // dump trash if truck is dumping
  if(truck.dumping){
    // we already created the pile
    truck.dumping=false;
  }

  // move truck
  truck.x += truck.speed;
  if(truck.x>w) { truck.x=-200; truck.dumping=true; dumpPile(); }

  // draw trash
  for(let t of trashItems){
    ctx.save();
    ctx.translate(t.x,t.y);
    t.draw(ctx,0,0);
    ctx.restore();
  }

  // draw correct rings
  for(let i=correctRings.length-1;i>=0;i--){
    const r=correctRings[i];
    ctx.beginPath();
    ctx.arc(r.x+25,r.y+25,r.r,0,Math.PI*2);
    ctx.strokeStyle=`rgba(255,215,0,${r.alpha})`;
    ctx.lineWidth=4;
    ctx.stroke();
    r.r += 2;
    r.alpha -=0.03;
    if(r.alpha<=0) correctRings.splice(i,1);
  }

  // draw wrong flashes
  for(let i=wrongFlashes.length-1;i>=0;i--){
    const f=wrongFlashes[i];
    ctx.fillStyle=`rgba(255,0,0,${f.alpha})`;
    ctx.fillRect(f.x,f.y,f.size,f.size);
    f.alpha -=0.05;
    if(f.alpha<=0) wrongFlashes.splice(i,1);
  }

  requestAnimationFrame(draw);
}

draw();
</script>

</body>
</html>
